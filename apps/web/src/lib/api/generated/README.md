# Generated API Types & SDK

This directory contains automatically generated TypeScript types and SDK from the backend API's OpenAPI/Swagger
specification.

## ⚠️ IMPORTANT: These files should be committed to Git

Unlike typical generated code, these files **should be committed** to the repository because:

1. **Development Workflow**: Developers can work on frontend code even when the API is offline
2. **Build Reliability**: CI/CD pipelines can build without requiring a running API server
3. **Version Control**: Changes to API contracts are tracked in version control
4. **Team Collaboration**: All team members have access to the latest types immediately

## Files Generated

- `types.gen.ts` - TypeScript type definitions from OpenAPI spec
- `sdk.gen.ts` - Generated SDK functions for all API endpoints
- `client.gen.ts` - HTTP client configuration and utilities
- `client/` - Client implementation files
- `core/` - Core utilities and types
- `index.ts` - Main export file
- `.api-metadata.json` - Generation metadata (hash, timestamp, API version)

## Usage

### Using the Generated SDK (Recommended)

```typescript
import { postApiProgramsByProgramIdActivityGrades, getApiProgramsByProgramIdActivityGradesStudentByProgramUserId } from '@/lib/api';

// Grade an activity
const gradeResult = await postApiProgramsByProgramIdActivityGrades({
  path: { programId: 'program-123' },
  body: {
    graderProgramUserId: 'user-456',
    programUserId: 'student-789',
    contentInteractionId: 'interaction-101',
    score: 95,
    feedback: 'Excellent work!',
  },
});

// Get student grades
const studentGrades = await getApiProgramsByProgramIdActivityGradesStudentByProgramUserId({
  path: {
    programId: 'program-123',
    programUserId: 'student-789',
  },
});
```

### Using with React Hooks

```typescript
import { useApi, useApiMutation } from '@/lib/hooks/useApi';
import { getApiProgramsByProgramIdActivityGradesStudentByProgramUserId } from '@/lib/api';

function StudentGrades({ programId, studentId }: { programId: string; studentId: string }) {
  const { data, loading, error } = useApi(
    () => getApiProgramsByProgramIdActivityGradesStudentByProgramUserId({
      path: { programId, programUserId: studentId }
    }),
    [programId, studentId]
  );

  if (loading) return <div>Loading...</div>;
  if (error) return <div>Error: {error.message}</div>;

  return (
    <div>
      {data?.data?.map(grade => (
        <div key={grade.id}>Score: {grade.score}</div>
      ))}
    </div>
  );
}
```

### Using Types Only

```typescript
import type { PostApiProgramsByProgramIdActivityGradesData } from '@/lib/api/generated/types.gen';

const gradeData: PostApiProgramsByProgramIdActivityGradesData = {
  path: { programId: 'program-123' },
  body: {
    // ... fully typed request body
  },
};
```

## How It Works

1. **Development Mode**: Types are automatically checked and regenerated if the API has changed
2. **Production Mode**: Uses the committed types without regeneration
3. **Smart Updates**: Only regenerates when the API specification actually changes (using SHA256 hash comparison)
4. **Fallback**: If API is offline, uses existing committed types

## Manual Regeneration

To manually regenerate types (useful after API changes):

```bash
npm run types:check
```

## Generated by

- Generator: `@hey-api/openapi-ts`
- Client: `@hey-api/client-next` (Next.js optimized)
- Source: Backend API Swagger/OpenAPI specification
- Last Updated: Check `.api-metadata.json` for timestamp

## Authentication

The generated client is configured to work with:

- JWT Bearer tokens
- Tenant-aware requests
- Next.js environment (SSR compatible)

All requests will automatically include proper authentication headers when configured.
